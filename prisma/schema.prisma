// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Model untuk Blog Post
model BlogPost {
  id          String   @id @default(uuid())
  title       String
  slug        String   @unique
  excerpt     String   @db.Text
  content     String   @db.Text
  image       String?  @db.LongText
  category    String
  author      String
  published   Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  authorId    String?
  authorUser  Admin?   @relation(fields: [authorId], references: [id], onDelete:Cascade)

  @@map("BlogPost")
}

// Enum untuk Role Admin
enum AdminRole {
  ADMIN      // Full access - bisa mengelola users, roles, dan semua content
  EDITOR     // Bisa mengelola content (blog post) tapi tidak bisa mengelola users/roles
  READ_ONLY  // Hanya bisa melihat dashboard dan content, tidak bisa edit/delete
}

// Model untuk Admin User
model Admin {
  id        String     @id @default(uuid())
  username  String     @unique
  password  String     // hashed password
  name      String
  email     String     @unique
  role      AdminRole  @default(READ_ONLY)
  lastLogin DateTime?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  // Relations
  blogPosts BlogPost[]
  popups    Popup[]

  @@map("Admin")
}

// Model untuk Popup Iklan
model Popup {
  id          String   @id @default(uuid())
  title       String
  type        PopupType @default(IMAGE)  // IMAGE or HTML
  content     String   @db.Text  // URL gambar atau HTML content
  link        String?  @db.LongText  // Link tujuan saat popup diklik
  isActive    Boolean  @default(false)
  delay       Int      @default(0)  // Delay dalam detik
  showClose   Boolean  @default(true)  // Tampilkan tombol close
  width       Int?     // Lebar popup (px)
  height      Int?     // Tinggi popup (px)
  createdBy   String   // ID admin yang buat
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  creator     Admin    @relation(fields: [createdBy], references: [id], onDelete:Cascade)

  @@map("Popup")
}

// Enum untuk Tipe Popup
enum PopupType {
  IMAGE  // Popup berupa gambar
  HTML   // Popup berupa HTML content
}
